/**
* Stylish Select 0.4.3 - $ plugin to replace a select drop down box with a stylable unordered list
* http://github.com/sko77sun/Stylish-Select
* 
* Requires: jQuery 1.3 or newer
* 
* Contributions from Justin Beasley: http://www.harvest.org/ Anatoly Ressin: http://www.artazor.lv/ Wilfred Hughes: https://github.com/Wilfred
* 
* Dual licensed under the MIT and GPL licenses.
*/
(function(a){a("html").addClass("stylish-select");if(!Array.prototype.indexOf){Array.prototype.indexOf=function(d){if(this===void 0||this===null){throw new TypeError()}var e=Object(this);var b=e.length>>>0;if(b===0){return -1}var f=0;if(arguments.length>0){f=Number(arguments[1]);if(f!==f){f=0}else{if(f!==0&&f!==(1/0)&&f!==-(1/0)){f=(f>0||-1)*Math.floor(Math.abs(f))}}}if(f>=b){return -1}var c=f>=0?f:Math.max(b-Math.abs(f),0);for(;c<b;c++){if(c in e&&e[c]===d){return c}}return -1}}a.fn.extend({getSetSSValue:function(b){if(b){a(this).val(b).change();return this}else{return a(this).find(":selected").val()}},resetSS:function(){var b=a(this).data("ssOpts");$this=a(this);$this.next().remove();$this.unbind(".sSelect").sSelect(b)}});a.fn.sSelect=function(b){return this.each(function(){var k={defaultText:"Please select",animationSpeed:0,ddMaxHeight:"",containerClass:""};var n=a.extend(k,b),f=a(this),l=a('<div class="selectedTxt"></div>'),t=a('<div class="newListSelected '+n.containerClass+'"></div>'),j=a('<div class="SSContainerDivWrapper" style="visibility:hidden;"></div>'),B=a('<ul class="newList"></ul>'),v=-1,e=-1,o=[],y=false,x=false,z;a(this).data("ssOpts",b);t.insertAfter(f);t.attr("tabindex",f.attr("tabindex")||"0");l.prependTo(t);B.appendTo(t);B.wrap(j);j=B.parent();f.hide();l.data("ssReRender",!l.is(":visible"));if(f.children("optgroup").length==0){f.children().each(function(D){var E=a(this).html();var C=a(this).val();o.push(E.charAt(0).toLowerCase());if(a(this).attr("selected")==true){n.defaultText=E;e=D}B.append(a('<li><a href="JavaScript:void(0);">'+E+"</a></li>").data("key",C))});z=B.children().children()}else{f.children("optgroup").each(function(){var C=a(this).attr("label"),E=a('<li class="newListOptionTitle">'+C+"</li>"),D=a("<ul></ul>");E.appendTo(B);D.appendTo(E);a(this).children().each(function(){++v;var G=a(this).html();var F=a(this).val();o.push(G.charAt(0).toLowerCase());if(a(this).attr("selected")==true){n.defaultText=G;e=v}D.append(a('<li><a href="JavaScript:void(0);">'+G+"</a></li>").data("key",F))})});z=B.find("ul li a")}var q=B.height(),p=t.height(),A=z.length;if(e!=-1){i(e,true)}else{l.text(n.defaultText)}function r(){var D=t.offset().top,C=jQuery(window).height(),E=jQuery(window).scrollTop();if(q>parseInt(n.ddMaxHeight)){q=parseInt(n.ddMaxHeight)}D=D-E;if(D+q>=C){B.css({height:q});j.css({top:"-"+q+"px",height:q});f.onTop=true}else{B.css({height:q});j.css({top:p+"px",height:q});f.onTop=false}}r();a(window).bind("resize.sSelect scroll.sSelect",r);function u(){t.css("position","relative")}function d(){t.css("position","static")}l.bind("click.sSelect",function(C){C.stopPropagation();if(a(this).data("ssReRender")){q=B.height("").height();j.height("");p=t.height();a(this).data("ssReRender",false);r()}a(".SSContainerDivWrapper").not(a(this).next()).hide().parent().parent().css("position","static").removeClass("newListSelFocus");j.toggle();u();z.eq(e).focus()});function c(){j.hide();d()}z.bind("click.sSelect",function(D){var C=a(D.target);e=z.index(C);x=true;i(e);c()});z.bind("mouseenter.sSelect",function(D){var C=a(D.target);C.addClass("newListHover")}).bind("mouseleave.sSelect",function(D){var C=a(D.target);C.removeClass("newListHover")});function i(C,G){z.removeClass("hiLite").eq(C).addClass("hiLite");if(j.is(":visible")){z.eq(C).focus()}var F=z.eq(C).text();var E=z.eq(C).parent().data("key");if(G==true){f.val(E);l.text(F);return false}try{f.val(E)}catch(D){f[0].selectedIndex=C}f.change();l.text(F)}f.bind("change.sSelect",function(C){$targetInput=a(C.target);if(x==true){x=false;return false}$currentOpt=$targetInput.find(":selected");e=$targetInput.find("option").index($currentOpt);i(e,true)});function s(C){a(C).unbind("keydown.sSelect").bind("keydown.sSelect",function(F){var E=F.which;x=true;switch(E){case 40:case 39:w();return false;break;case 38:case 37:m();return false;break;case 33:case 36:h();return false;break;case 34:case 35:g();return false;break;case 13:case 27:c();return false;break}keyPressed=String.fromCharCode(E).toLowerCase();var D=o.indexOf(keyPressed);if(typeof D!="undefined"){++e;e=o.indexOf(keyPressed,e);if(e==-1||e==null||y!=keyPressed){e=o.indexOf(keyPressed)}i(e);y=keyPressed;return false}})}function w(){if(e<(A-1)){++e;i(e)}}function m(){if(e>0){--e;i(e)}}function h(){e=0;i(e)}function g(){e=A-1;i(e)}t.bind("click.sSelect",function(C){C.stopPropagation();s(this)});t.bind("focus.sSelect",function(){a(this).addClass("newListSelFocus");s(this)});t.bind("blur.sSelect",function(){a(this).removeClass("newListSelFocus")});a(document).bind("click.sSelect",function(){t.removeClass("newListSelFocus");c()});l.bind("mouseenter.sSelect",function(D){var C=a(D.target);C.parent().addClass("newListSelHover")}).bind("mouseleave.sSelect",function(D){var C=a(D.target);C.parent().removeClass("newListSelHover")});j.css({left:"0",display:"none",visibility:"visible"})})}})(jQuery);